# Anomaly Detection Memo

## 📚 Anomaly Detection 的三種方法

### 1. 無監督異常值檢測 (Unsupervised Outlier Detection)
- 使用未標記的訓練數據，包含正常和異常觀察值。
- 模型在訓練過程中自動識別低密度區域中的異常點。
- 適合處理異常點分佈在低密度區域的情境。

### 2. 半監督新穎性檢測 (Semi-supervised Novelty Detection)
- 訓練數據僅包含描述正常行為的樣本。
- 偵測與訓練數據分佈不同的新觀察值。
- 即使新觀察值形成高密度區域，也會被視為異常。

### 3. 監督異常值分類 (Supervised Outlier Classification)
- 使用帶有標籤（內點或外點）的訓練數據進行分類。
- 適用於不平衡數據集，並假設異常分佈與訓練集一致。
- 適合有標記異常數據的場景。

📖 **參考文獻**：[PYOD 1.0.7 Documentation](https://pyod.readthedocs.io/en/latest/relevant_knowledge.html#)

## 🛠️ 無監督異常值檢測 SOP

### 操作步驟

1. **定義異常**
   - 明確說明需要檢測的異常類型。

2. **評估歷史資料的異常點數量**
   - **多**：使用監督方法（此篇不涵蓋）。  
   - **少**：使用非監督方法。

3. **確認探針數量**
   - 確定手上可用的特徵數量。

4. **選擇非監督算法**
   - 例如：[GMM (Gaussian Mixture Model)](https://pyod.readthedocs.io/en/latest/index.html)

5. **設定 contamination 參數**
   - 假設訓練數據中異常比例，建議初始值為 `0.000`，實際需根據數據調整。

6. **進行滑動窗口處理**
   - 建議窗口大小：`30`。  
   - 將過去數據納入分析，捕捉特徵模式的變化。

7. **計算異常分數**
   - 將特徵轉換為每個數據點的異常分數。

8. **可視化分析**
   - 繪製異常點前後特徵分數的變化。  
     - 建議範圍：前 `120` 點，後 `60` 點。  
   - 找出異常點前分數飆升的特徵。

9. **迭代調整參數**
   - 若無法找到有效特徵，需重新調整：
     - 算法參數。
     - 滑動窗口大小。
     - 確認其他可能的探針。

10. **標記有效特徵**
    - 將異常點前有反應的特徵設為有效探針。  
    - 設定門檻值作為告警線。

11. **驗證與優化**
    - 使用有效探針檢測未標記的異常時段，與業務單位確認真實性。  
    - 調整門檻，並設計投票或加權機制以完成告警模型。

## 📌 注意事項
- 滑動窗口大小應根據資料特性調整。  
- 設定門檻值時，需考慮實際業務需求與數據分佈。  
- 持續迭代模型，確保其準確性與穩定性。

此流程將協助團隊建立高效且可靠的異常檢測系統，從數據中挖掘價值以支持業務決策。
